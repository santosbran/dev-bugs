<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">
    <f:view locale="#{swtLanguage.locale}" rendered="#{loginInit.login()}">
    <h:head>
        <title>TODO supply a title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <h:outputStylesheet library="styleAE" name="alerts/alertify.core.css"/>
        <h:outputStylesheet library="styleAE" name="alerts/alertify.default.css"/>
        <h:outputStylesheet library="styleAE" name="css/events-styles.css"/>
        <h:outputStylesheet library="styleAE" name="css/styleAEIS.css"/>
        <h:outputStylesheet library="styleAE" name="css/bootstrap.min.css"/>
        <h:outputStylesheet library="styleAE" name="font-awesome/css/font-awesome.css"/>
        <h:outputStylesheet library="styleAE" name="css/component-styles.css"/>
        
    </h:head>
        <style>
            .fuentesizeTableComponente {
                font-size: 11px !important;
            }
            .ui-button-text-only .ui-button-text {
                padding: 0.0em 0em;
                /* float: right; */
            }
            .ui-state-focus{
                background: white !important;
            }
            .btn-circle.btn-xl {
                width: 24px;
                height: 24px;
            font-size: 20px;
                line-height: 1.33;
            border-radius: 35px;
                background-color: #003c72;
                margin: 0.09% 0% 0% 0.3%;
            float: left;
            position: absolute;
            }
            .btn-danger{
                border-color: #003c72;
            }
            .two-prc {
                    width: 2%;
                }
                .six-prc{
                    width: 6%;
                }
                .ten-prc{
                    width: 10%;
                }
                .twenty-prc{
                    width: 20%;
                }
                .eight-prc{                    
                    width: 30% !important;
                }
                .ui-datatable .ui-sortable-column-icon {
                    display: inline-block;
                    margin: -3px 0 -3px 2px;
                    display: none !important;
                }
                .imageChequeo{    
                    background-image: url("#{resource['styleAE:img/main/FleETRed-01.png']}") !important;
                    background-repeat: no-repeat !important;
                    background-position: 40% -5px !important;
                    background-size: 23px 45px;
                    margin-top: 2% !important;
                }
                
        </style>
        <script>
            function oliface(tr){      
                console.log("Ingreso al Click.");
                window.parent.document.getElementById("insertarIDECR:idESTImputTECR").value = tr;
                window.parent.document.getElementById("insertarIDECR:idECRButton").click();
            }  
            function addECRTABECR(){
                window.parent.document.getElementById("formECRForAir:addECRForAir").click();
            } 
        </script>
    <h:body>
        
        <style type="text/css">
            .ui-log {
                left: 750px;
                top: 250px;
            }
        </style>
        
        <h:form id="fmEsrTabNwECR" class="fuentesizeTableComponente" >
            <p:log id="log"/>
            
            <p:commandButton id="addECR" class="btn-circle btn-xl btn-danger"  value="+"  onclick="addECRTABECR();">
                
            </p:commandButton>
            <p:dataTable id="tblListadosECRTabNw" var="item" value="#{engtabEsrnwsVwBean.listadoEcr}" paginator="true" rows="25" 
                         paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}" 
                         currentPageReportTemplate="{endRecord} #{gen_msg['adjLisIngre2']} {totalRecords}, #{gen_msg['page']} {currentPage} #{gen_msg['adjLisIngre2']} {totalPages}"
                         rowsPerPageTemplate="5,10,25,50,100" editable="true">
                
                <p:ajax event="page" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR" />
                <p:ajax event="filter" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR" />
                <p:ajax event="sort" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR"/>
                <p:ajax event="toggleSelect" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR"/>
                <p:ajax event="rowUnselectCheckbox" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR"/>    
                <p:ajax event="rowSelectCheckbox" update="tblListadosECRTabNw fmEsrTabNwECR:scroptPECR fmEsrTabNwECR:scroptP2ECR"/>
                <p:column headerText="No" filterBy="#{engtabEsrnwsVwBean.listadoEcr.indexOf(item)+1}" sortBy="#{engtabEsrnwsVwBean.listadoEcr.indexOf(item)+1}" filterMatchMode="contains" class="two-prc" >
                    <h:outputText value="#{engtabEsrnwsVwBean.listadoEcr.indexOf(item)+1}"/>
                </p:column>
                
                <p:column headerText="ID" filterBy="#{item.reqMessageid}" sortBy="#{item.reqMessageid}" filterMatchMode="contains" style="display: none;">
                    <h:outputText value="#{item.reqMessageid}"/>
                </p:column>
                <p:column headerText="#{gen_msg['card']}" filterBy="#{item.card}" sortBy="#{item.card}" filterMatchMode="contains" >
                    <h:outputText value="#{item.card}"/>
                </p:column>
                   <p:column headerText="#{gen_msg['subject']}" filterBy="#{item.probdesc}" sortBy="#{item.probdesc}" filterMatchMode="contains" class="eight-prc">
                    <h:outputText value="#{item.probdesc}"/>
                </p:column>
                <p:column headerText="ECR" filterBy="#{item.esr}" sortBy="#{item.esr}" filterMatchMode="contains" class="six-prc">
                    <h:outputText value="#{item.esr}"/>
                </p:column>
                <p:column headerText="#{gen_msg['date']}" filterBy="#{item.issuedate}" sortBy="#{item.issuedate}" filterMatchMode="contains" >
                    <h:outputText value="#{item.issuedate}">
                         <f:convertDateTime pattern="MM/dd/yyyy hh:mm a" timeZone="GMT-6" />
                    </h:outputText>
                </p:column>
                <p:column headerText="#{gen_msg['disposition']}" filterBy="#{item.disposition}" sortBy="#{item.disposition}" filterMatchMode="contains" class="eight-prc">
                    <h:outputText value="#{item.disposition}"/>
                </p:column>
                <p:column headerText="#{gen_msg['actor']}" filterBy="#{item.actor}" sortBy="#{item.actor}" filterMatchMode="contains" >
                    <h:outputText value="#{item.actor}"/>
                </p:column>    
                <p:column headerText="EOs" filterBy="#{item.numata}" sortBy="#{item.numata}" filterMatchMode="contains" >
                    <h:outputText value="#{item.numata}"/>
                </p:column>
                <p:column headerText="#{gen_msg['owner']}" filterBy="#{item.clasrepair}" sortBy="#{item.clasrepair}" filterMatchMode="contains" >
                    <h:outputText value="#{item.clasrepair}"/>
                </p:column>
                <p:column headerText="#{gen_msg['assigned']}" style="display: none;">
                    <h:outputText value="#{item.reqCodIngEnc}"/> 
                </p:column>    
                <p:column headerText="#{gen_msg['status']}" filterBy="#{item.reqStatus}" sortBy="#{item.reqStatus}" filterMatchMode="contains" style="display: none;">
                    <h:outputText id="status" value="#{item.reqStatus}"/>
                </p:column> 
                <p:column headerText="#{gen_msg['mod']}">
                    <h:graphicImage library="styleAE" name="img/main/FleETRed-01.png"  class="img-responsive pull-left" style="display:#{item.review eq 'NO' and item.rolUser ne tabEsrEaEoBean.roles ? 'inline-block;':'none'};margin: 0% 0% 0% 25%;"/>                                                       
                </p:column> 
            </p:dataTable>
            <h:panelGroup id="scroptPECR" rendered="#{engtabEsrnwsVwBean.listadoEcr.size()>0}">
                <h:outputScript>
                    splitmesa0ECR();
                    function splitmesa0ECR(){ 
                        $("#fmEsrTabNwECR\\:tblListadosECRTabNw tbody tr").each(function (index) { 
                        
                        if($(this).children("td")[11] !== undefined){
                        
                        var text0=$(this).children("td")[11].textContent;
                        var text1=$(this).children("td")[10].textContent;
                        //$(this).css("background","#b3b8bd");
                            if(text0 != "NFA" &amp;&amp; text0 != "FPP" &amp;&amp; text0 != "FDP" &amp;&amp; text0 != "C") {
                                //$(this).css("background","#ffffff");
                                $(this).css("background","#b3b8bd");
                                if(text1==0){
                                $(this).css("background","#F78181");
                                }
                            }
                            }
                        });
                        
                    }
                </h:outputScript>
                <h:panelGroup id="scroptP2ECR" rendered="#{engtabEsrnwsVwBean.listadoEcr.size()>0}"> 
                <h:outputScript>
                    splitmesa();
                    function splitmesa(){   
                        $("#fmEsrTabNwECR\\:tblListadosECRTabNw tbody tr").each(function (index) {
                        if($(this).children("td")[1] !== undefined){
                        var chel=$(this);
                        var text1=$(this).children("td")[1].textContent;
                        console.log("text1: "+text1);
                        chel.attr('onclick', 'oliface('+text1+');');
                        chel.attr('id', 'idEsr'+index);
                        }
                        });
                        
                    } 
                </h:outputScript>
                    </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </h:body>
    </f:view>
</html>