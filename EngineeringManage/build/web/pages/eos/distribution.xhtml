<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <f:view>
        <h:head>
            <title> </title> <!-- Nombre de la página - aplicación -->
            
            <h:outputStylesheet library="styleAE" name="polaris/css/Font-GalaxiePolarisV2.css"/>

            <h:outputScript>
                $(document).ready(function (){
                crearModal('#inputModaldis', '675px');
                });
                $(function ()
                {
                var sel =document.getElementById("matrona:idorder").value; 
                if(sel == 7){
                $("#collapse3").show();
                }
                });
                 
            </h:outputScript>

        </h:head>
        <h:body>
                <div style="margin: auto; width: 95%; " class="fondo">
                    <div>
                    <h1 class="page-header" style="color: red; ">
                        #{gen_msg['distribution']}                                   
                    </h1>
                </div>
                        
                                <h:form id="resultFormdist" style="float:left;width: 100%">
                                    <h:dataTable id="tblListadodist" pt:name="tblListadodist" value="#{distributionBean.listado}" var="item" style="width:100%; padding: 5px;" class="table table-striped dt-responsive nowrap">
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputText value="#{gen_msg['id']}"/>
                                            </f:facet>
                                            <f:facet name="footer">
                                                <h:outputText value="#{gen_msg['id']}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.engDistributionListsPK.dlcId}"/>
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputText value="Eng Order"/>
                                            </f:facet>
                                            <f:facet name="footer">
                                                <h:outputText value="Eng Order  "/>
                                            </f:facet>
                                            <h:outputText value="#{item.engDistributionListsPK.eoIdord}"/>
                                        </h:column>

                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputText value="#{gen_msg['comments']}"/>
                                            </f:facet>
                                            <f:facet name="footer">
                                                <h:outputText value="#{gen_msg['comments']}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.dlComments}"/>
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputText value="Valor del Item"/>
                                            </f:facet>
                                            <f:facet name="footer">
                                                <h:outputText value="Valor del Item"/>
                                            </f:facet>
                                            <h:outputText value="#{item.dlValue}"/>
                                        </h:column> 
                                        <h:column>
                                            <h:commandButton class="btn-round-24 icon-edit-24" onclick="mostrarModal('#inputModaldis');">
                                                <f:ajax execute="@this" render="inputFormdistr refremeta" />
                                                <f:setPropertyActionListener target="#{distributionBean.elemento}" value="#{item}"/>
                                                <f:setPropertyActionListener target="#{distributionBean.edit}" value="#{true}"/>
                                                <f:setPropertyActionListener target="#{distributionBean.pk}" value="#{item.engDistributionListsPK}"/>
                                                <f:setPropertyActionListener target="#{distributionBean.dlValue}" value="#{item.engDistributionListsPK eq Y ?true:false}"/>

                                            </h:commandButton>
                                        </h:column>
                                        <h:column>
                                            <h:commandButton class="btn-round-69 icon-remove-69" action="#{distributionBean.eliminar(item)}">
                                                <f:ajax execute="@this" render="@form refremeta" />
                                            </h:commandButton>
                                        </h:column>
                                    </h:dataTable>
                                    <!--Aplicando el formato a la datatable, se hace de esta forma para que se aplique nuevamente tras el rerenderizado del form-->
                                    <h:outputScript>formatTable('table[name=tblListadodist]','${swtLanguage.language}','#inputModaldis');</h:outputScript>
                                </h:form>
                            
                    

            <!-- modal para el ingreso de información -->    
            <h:panelGroup id="inputModaldis" style="display:none;" pt:title="#{gen_msg['distribution']}" >
                <h:form id="inputFormdistr">
                    <script>
                        $(document).ready(function (){
                            crearModal('#inputModaldis', '675px');
                            });
                    </script>
                    <h:panelGrid style="width: 100%" columns="4" columnClasses="twentyfive-prc right-aling, twentyfive-prc, twentyfive-prc right-aling, twentyfive-prc " >
                        <h:outputLabel value="Eo IdOrd :" style="margin-left: 25px"/>
                        <h:inputText id="Dlc_Id" readonly="true" class="form-control" title="id" value="#{distributionBean.pk.eoIdord}"/>
                        <h:outputLabel value="Dl Value:"/>
                        <h:selectBooleanCheckbox value="#{distributionBean.dlValue}"/>

                    </h:panelGrid>
                    <h:panelGrid style="width: 100%" columns="2" columnClasses="twentyfive-prc, seventyfive-prc">
                        <h:outputLabel value="#{aees_msg['remarks']}:" for="Remarks"/>
                        <h:inputTextarea id="Remarks"  class="form-control"  style="resize: none" value="#{distributionBean.elemento.dlComments}"/> 
                    </h:panelGrid>

                    <h:messages class="msgError"/>
                    <h:panelGrid columns="2" style="margin:auto;">
                        <h:commandButton class="btn btn-signin" value ="#{!distributionBean.edit ? gen_msg['genAdd'] : gen_msg['genUpdate']}" action="#{distributionBean.guardar()}" >
                            <f:ajax execute="@form" render="onsuccessdis @form resultFormdist refremeta"/>
                        </h:commandButton>
                        <h:commandButton class="btn btn-signin" value ="Descartar" action="#{distributionBean.limpiar()}" >
                            <f:ajax execute="@this" render="onsuccessdis @form refremeta" />
                        </h:commandButton>
                    </h:panelGrid>
                    <!-- aplicando formato a los DTP, se ejecuta de esta forma para que cuando se rerenderize el elemento se vuelva a aplicar el formato-->
                    
                </h:form>
                <!--Se renderiza si no hay errores de forma que se cierre la modal al llamar descartar o guardar-->
                
            </h:panelGroup>
            <h:panelGroup id="onsuccessdis">
                    <h:outputScript rendered="#{facesContext.postback and not facesContext.validationFailed}">
                        $("#inputModaldis").dialog("close");
                    </h:outputScript>
                </h:panelGroup>
                </div>
        </h:body>
    </f:view>
</html>