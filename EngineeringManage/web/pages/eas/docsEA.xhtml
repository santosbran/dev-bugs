<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <f:view>
        <h:head>
            <title></title>
            <h:outputStylesheet library="styleAE" name="css/engStyles.css"/>
            <h:outputScript library="styleAE" name="js/jquery.MultiFile.js" />
            <h:outputScript library="styleAE" name="js/engLibrary.js" />

            <style>
                #page-wrapper0 {
                    padding: 0px 41px;
                }
                .container-fluid0 {
                    padding-right: 15px;
                    padding-left: 15px;
                    margin-right: auto;
                    margin-left: auto;
                    padding: 10px 0px 0px;
                }
                
                .divBotonesDocEA {
                    width: 100%;
                    padding-left: 24%;
                    padding-right: 10%;
                    margin-top: 1%;
                    margin-left: 11%;
                }
                
                @media screen and (max-width: 1250px){
                    .divBotonesDocEA{
                        width: 121% !important;
                        margin-left: 6% !important;
                    }                    
                }
                @media screen and (max-width: 1000px){
                    .divBotonesDocEA{
                        width: 146% !important;
                        margin-left: -4% !important;
                    }                    
                }
                     @media screen and (max-width: 800px){
                    .divBotonesDocEA{
                        width: 170% !important;
                        margin-left: -8% !important;
                    }                    
                }
                     @media screen and (max-width: 650px){
                    .divBotonesDocEA{
                        width: 213% !important;
                        margin-left: -19% !important;
                    }                    
                }
            </style>
            <script>
                function trackingNewEA(){
                    $('#docea').hide(); 
                    $('#tabTackingESRNew').show();
                    window.switchSpaceNav();
                }
                function backEADocumentfun(){
                    $("#eaForm").show(); 
                    $("#docea").hide();
                }
            </script>

        </h:head>
        <h:body>
           

            <h:panelGroup>
                <script type="text/javascript">
                    $(document).ready(function () {
                        crearModal('#inputModal71', '675px');
                        
                         crearModal('#modTrackingDocs', '65%');
                        $( "#modTrackingDocs" ).dialog( "option", "title", "#{aees_msg['engRequestTracking']}" );
                    });
                </script>
            </h:panelGroup>

            <div class="dashboard-content-h">
                <h:form id="menuDhashBordx5" style="display: none;"> 
                    <div id="icoBack5" onmouseover="null" onmouseout="null"
                         class="btn btn-signin butomclassesr fondoMenuAEIS " title="Back" style="position: fixed;top: 15px;height: 38px;" onclick="$('#divOtrosDocs').hide(); $('#esr').show();mostrarbtn();" >
                        <h:graphicImage  id="imgBack5" library="styleAE" name="img/main/anterior.png" style="width: 100%;margin: -5px;"/>                                   
                    </div> 
                </h:form> 
                
                                <div id="panelEAutoEA" style="overflow-y: auto; background: white;" class="h-full">
                    <h:form id="inputFormDocEA" style="width: 96% !important;margin: auto;background: white;"  enctype="multipart/form-data">
                    <h:inputHidden id="eagId1" class="form-control" value="#{eaPdfBean.elemento.eagId}" />
                    <h:inputHidden id="esrId" class="form-control"  value="#{engAutorizationBean.elemento.reqMessageid}" />
                    <h:panelGrid class="tableeo" columns="1" columnClasses="twentyfive-prc, seventyfive-prc " style="margin: auto; height: 100px;">
                        <h:column>
                            <h:outputText value="#{aees_msg['eaLoadDocs']}" class="h4" />
                            <hr style="border-top-color: red;" />
                        </h:column>
                    </h:panelGrid>
                    <div  class="flex justify-center flex-wrap w-full h-full mx-auto" style="max-width: 1000px;">
                        <div class="form-esr-col flex flex-col md:flex-row w-1/2 p-2">
                            <div class="form-esr-label">

                        <h:outputLabel value="#{aees_msg['idEA']}" for="eagId0" />
                        </div>
                            <div class="form-esr-control">
                        <h:inputText id="eagId0" class="form-control" readonly="true" value="#{engAutorizationBean.elemento.eagId}" style="width: 80%" />
                            </div>
                        </div>
                        
                        
                           <div class="form-esr-col flex flex-col md:flex-row w-1/2 p-2">
                            <div class="form-esr-label">
                                <h:outputLabel for="type">
                                    #{gen_msg['type']}
                                    <h:outputText value="  *  " class="msgError"/>
                                </h:outputLabel>
                            </div>
                            <div class="form-esr-control">
                        <h:selectOneMenu id="type" value="#{eaPdfBean.docname}" class="form-control"
                                         required="true" requiredMessage="#{gen_msg['type']} #{gen_msg['adjNecesario']}" >
                            <f:selectItem itemLabel="...." itemValue="#{null}"/>
                            <f:selectItem itemLabel="Cover R0" itemValue="Cover R0"/>
                            <f:selectItem itemLabel="Parts" itemValue="Parts"/>
                            <f:ajax execute="@this" event="change" render="@this msgtype refremeta"/>
                        </h:selectOneMenu>   
                                 </div>
                        </div>
                        <div class="form-esr-col flex flex-col md:flex-row w-full p-2">
                            <div class="form-esr-label">
                        
                                                        <h:outputLabel for="coment">
                                    #{gen_msg['coment']}
                                    <h:outputText value="  *  " class="msgError"/>
                                </h:outputLabel>
                                </div>
                            <div class="form-esr-control">
                        <h:inputTextarea id="coment"  class="form-control"  value="#{eaPdfBean.elemento.pdfComent}" style=" resize: none" 
                                         required="true" requiredMessage="#{gen_msg['coment']} #{gen_msg['adjNecesario']}" >
                            <f:ajax execute="@this" event="keyup" render="msgcomment refremeta"/>
                        </h:inputTextarea>
                        </div>
                        </div>
                        <div class="form-esr-col flex flex-col md:flex-row w-full p-2" style="height: 58px;">
                            <div class="form-esr-label">
                                <h:outputLabel for="Adjunto">
                                    #{gen_msg['attached']}
                                    <h:outputText value="  *  " class="msgError"/>
                                </h:outputLabel>
                            </div>
                            <div class="form-esr-control">
                                <h:inputFile id="Adjunto" style="border:#999 dotted 1px; padding:10px; width: 100%;" value="#{eaPdfBean.file}" 
                                    required="true" requiredMessage="#{gen_msg['attached']} #{gen_msg['adjNecesario']}" >
                                    <f:ajax execute="@this" event="change" render="msAdjunto resultForm71 refremeta"/>
                                </h:inputFile>
                                <h:outputLabel class="msgError" value="â€¢  #{gen_msg['file']} #{gen_msg['invfor']} .pdf" rendered="#{eaPdfBean.archivomalo}"/>
                            </div>
                        </div>
                        <div class="flex flex-col justify-start">
                            <h:messages id="msgtype" for="type" class="msgError"/>
                            <h:messages id="msgcomment" for="coment" class="msgError"/>
                            <h:messages id="msAdjunto" for="Adjunto" class="msgError"/>
                        </div>
                    </div>
                    
                    <h:panelGrid columns="2" class="tableeo" columnClasses="ten-prc right-align, ten-prc right-align" style="margin: 2% 0% 0% 27%; width: 50%;">
                       <h:column>
                           <h:commandButton class="btn btn-signin" value ="#{!eaPdfBean.edit ? gen_msg['genAdd'] : gen_msg['genUpdate']}" action="#{eaPdfBean.addfile()}" >
                                <f:ajax execute="@form" render="@form onsuccessDocEA resultForm71 mensajesId inputForm68 refremeta"/>
                            </h:commandButton>
                       </h:column>
                       <h:column>
                           <h:commandButton class="btn btn-signin" value ="#{gen_msg['discard']}" action="#{eaPdfBean.limpiar()}" >
                                <f:ajax execute="@this" render="scriptEADoc @form ondescarEADoc refremeta resultForm71" />
                            </h:commandButton>
                       </h:column>                       
                   </h:panelGrid>
                    <h:panelGroup id="mensajesId" >

                        <h:outputScript rendered="#{facesContext.postback and facesContext.validationFailed and eaPdfBean.existecover}">;
                            alertify.error("#{aees_msg['coverNoPart']}");
                        </h:outputScript>

                    </h:panelGroup>
                </h:form>
                

                <h:form id="resultForm71" style="width:96%;margin: auto;background: white;">
                    <h:dataTable id="tblListado71" class="table table-striped dt-responsive nowrap" 
                                 pt:name="tblListado71" value="#{eaPdfBean.listado2}" var="item" style="width: 96% !important">
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['type']}"/>
                            </f:facet>                                    
                            <h:outputText style="display: #{item.pdfType eq 0 ? 'none':'block'}" value="COVER"/>
                            <h:outputText style="display: #{item.pdfType eq 0 ? 'block':'none'}" value="PART"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{aees_msg['name']}"/>
                            </f:facet>                                    
                            <h:outputText value="#{item.pdfFilename}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['coment']}"/>
                            </f:facet>
                            <h:outputText value="#{item.pdfComent}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['Docs']}"/>
                            </f:facet>
                            <h:commandLink   action="#{eaPdfBean.recuperarBlob(item.pdfFilename,item.pdfId)}">
                                <span class="glyphicon glyphicon-paperclip" style="color: black;font-size: 20px;"></span>
                            </h:commandLink>
                        </h:column>                        
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['date']}"/>
                            </f:facet>
                            <h:outputText value="#{item.pdfDateChr}">
                                <f:convertDateTime pattern="#{gen_msg['frmtDateConv']}" timeZone="GMT-6"/>
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['status']}"/>
                            </f:facet>
                            <h:outputText value="#{item.pdfEstatusEnviado eq 'ENVIADO' ? gen_msg['genEnv']:gen_msg['genCar'] }"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="#{gen_msg['tracking']}"/>
                            </f:facet>
                            <h:commandButton class="btn btn-signin-model" value ="#{gen_msg['send']}" 
                                             onclick="trackingNewEA();" action="#{RequestTracking.enviarEA(item.pdfId,engAutorizationBean.elemento.reqMessageid)}">
                                <f:ajax execute="@form" render="inputFormtraTbl2_2 inputFormtraTblEA converea inputForm73_2 inputFormtra refremeta panalTrakingframe resultadosTracking"/>
                            </h:commandButton>
                        </h:column>
                    </h:dataTable>
                    
                   
                    <script>
                        formatTable('table[name=tblListado71]','${swtLanguage.language}','#inputModal71','.menut8');
                        var eaid = document.getElementById("inputFormDocEA:eagId0").value;
                        document.getElementById("inputFormDocEA:eagId1").value = eaid;
                    </script>
                </h:form>
                    </div>

            </div>
            
            <h:panelGroup id="modTrackingDocs" style="display:none;" class="modalhe">
                
                 <h:form id="modTrackingForm" style="height: 15%;">

                    <h:panelGrid columns="1" style="margin:auto;">
                        <h:commandButton class="btn btn-signin" value ="#{gen_msg['discard']}" onclick="$('#modTracking').dialog('close');" >
                            <f:ajax execute="@form" listener="#{tabEsrEaEoBean.ea(engAutorizationBean.elemento.eagId)}" render="@form matrona scrip part scripea resultForm71 inputForm73_2 refremeta"/>
                        </h:commandButton>
                    </h:panelGrid>
                </h:form>
            </h:panelGroup>
            <h:panelGroup id="ondescarEADoc">
                        <h:outputScript rendered="#{facesContext.postback and not facesContext.validationFailed}">                            
                            alertify.custom = alertify.extend("custom");
                            alertify.custom("#{aees_msg['descardoperation']}");
                        </h:outputScript>
                    </h:panelGroup>

            <h:panelGroup id="onsuccessDocEA">
                <h:outputScript rendered="#{facesContext.postback and not facesContext.validationFailed}">
                    alertify.success("#{aees_msg['exito']}");
                </h:outputScript>
            </h:panelGroup>
            <h:panelGroup id="backDocmentEAFun">
                <h:outputScript rendered="#{facesContext.postback and not facesContext.validationFailed}">
                    backEADocumentfun();
                </h:outputScript>
            </h:panelGroup>



        </h:body>
    </f:view>
</html>
