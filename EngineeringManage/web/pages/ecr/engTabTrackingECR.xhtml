<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <f:view>
        <h:head>
            <title></title>           
            <style>  
                .ocultarTracking{
                    display: none !important; 
                }
                #dasTabECR {
                    position: fixed;
                    margin-top: -170px;
                    height: 65%;
                    left: 75%;
                    right: 0.99%;
                }  
                .two-prc {
                    width: 2%;
                }
                .three-prc {
                    width: 3%;
                }
                .six-prc{
                    width: 6%;
                }
                .eight-prc{                    
                    width: 30% !important;
                }
                .ui-widget-content {   
                    background: #fff !important;

                }
                .p.a {
                    word-break: break-all;
                }
                #fmECRTabNw > .scrollDashES >  .dataTables_wrapper {
                    width: 98%;
                    left: 1%;
                }
                .scrollDashES {
                    display: block;
                }
                
                
                @media (min-width: 0px) and (max-width: 500px){
                    .scrollDashES{                        
                        height: 430px;
                    }
                 #fmECRTabNw > .scrollDashES > .dataTables_wrapper {
                        width: 144%;
                        left: 1%;
                    }
                }
               #fmECRTabNw > .scrollDashES >  .dataTables_wrapper{
                    height: 65% !important;
                    position: fixed;
                    overflow: auto;

                }
                #icoBackDash{
                    position: relative;
                    top:18px; 
                    z-index: 999999999999;
                    height: 37px;
                }
                .scrollDashES{
                    position: relative;
                    top: 9px; 
                    padding: 50px 0 0 0;
                }
                .anchoTableMantenimientos {
                    margin-left: 0.3% !important;
                    margin-right: auto !important;
                    width: 99% !important;
                    height: 100% !important;
                    overflow: auto !important;
                    padding: 0 0 50px 0;

                } 
                #workOrder{
                    position: fixed;
                    top: 4px;
                    font-size: 25px;
                    font-weight: bold;
                    left: 68%;
                }
                .closes{
                    background: gray;
                }
                .menuTracking {
                    z-index: 999; 
                    margin: 0% 0% 0% 40%;
                }
                .menuDivTracking {
                    background: rgba(205,204,204,0.65) !important;
                }
                .divTitleTracking{
                    background-color: gray !important; 
                    border-bottom: 3px solid #bf1e2d; 
                    border-left: 3px solid #bf1e2d; 
                    padding: 6px 10px 0px 10px !important;
                }
                .labelTitleTracking{
                    margin-left: 1%; 
                    text-transform: uppercase !important; 
                    font-size: 12px !important; 
                    color: white !important;
                }
                .menuDivTracking > .menuTracking > .dt-button{
                    margin-top: 0.5%
                }
                .fmTrackingTabAS{
                    height: 87%; 
                    margin: 0% 1% 0% 1%; 
                    overflow: auto !important;
                }
                
                
                 @media (max-width: 895px) and (min-width: 816px){
                    #fmTrackingTabNw{
                        margin: 11% 1% 0% 1%; 
                    }
                    #menuTabTrackingAS > .btn {
                        top: -23px !important;
                    }
                }
                @media (max-width: 815px) and (min-width: 791px){
                    #fmTrackingTabNw{
                        margin: 13% 1% 0% 1%; 
                    }
                    #menuTabTrackingAS > .btn {
                        top: -8px !important;
                    }
                }
                @media (max-width: 790px) and (min-width: 650px){
                    #fmTrackingTabNw{
                        margin: 16% 1% 0% 1%; 
                    }
                    #menuTabTrackingAS > .btn {
                        top: 15px !important;
                    }
                }
                @media (max-width: 649px) and (min-width: 500px){
                    #fmTrackingTabNw{
                        margin: 21% 1% 0% 1%; 
                    }
                    #menuTabTrackingAS > .btn {
                        top: 15px !important;
                    }
                }
                
                
            </style>
            <script>
                function selectTabTracking(tr){
                        $("#selectIDTracking\\:idTrackingImputT").val(tr);
                        $("#selectIDTracking\\:idTrackingButton").trigger("click");
                    }
                function renderisarTracking(){
                    $("#tabTackingECRNew").hide();
                    $("#trackingECRNew").show();
                }
                function addTracking(){
                    $("#tabTackingECRNew").hide();
                    $("#trackingECRNew").show();
                    $("#selectIDTracking\\:addTrackingNew").trigger("click");
                                        
                }
                function backSupervisor(){
                    $('#tabTackingECRNew').hide(); 
                    $('#trackingECRNew').hide(); 
                    $('#engineer').show();
                    $('#main').show();    
                    $('#supervisor').show();
                }
                                                    
                        
            </script>
        </h:head>
        <h:body>
            <h:form id="insertarIDTracking" style="display: none;">
                <h:inputHidden value="#{engtabECRnwsVwBean.idECRTab}" id="idTrackingImputT">

                </h:inputHidden>  
                <h:commandButton id="idTrackingButton" action="#{engtabECRnwsVwBean.seleccionarTabla(engtabECRnwsVwBean.idECRTab)}" style="display: none;">
                    <f:ajax execute="@form" render="validarSeleccionNWSECR inputForm70 resultabtodosComp refremeta" />
                </h:commandButton>

            </h:form>
            <h:form id="selectIDTracking" style="display: none;">                
                <h:inputHidden value="#{AdjuntosBean.idReqResponse}" id="idTrackingImputT"/>
                <h:commandButton id="idTrackingButton" onclick="renderisarTracking()" action="#{RequestTracking.findMailSend()}" style="display: none;">
                    <f:ajax execute="@form" render="@form inputFormtra sliTracking refremeta panalTrakingframe" />
                </h:commandButton>
                <h:commandButton id="addTrackingNew" value ="#{gen_msg['tracking']}" action="#{tabECREaEoBean.trackingECRPanelDerecho()}" style="display:none">
                    <f:ajax execute="@this" render="@this resultadosTracking fmTrackingTabNw panalTrakingframe inputFormtraTbl inputFormtra formP sliTracking refremeta" />
                </h:commandButton>
            </h:form>
            
            <h:form id="menuTabTrackingAS"> 
                <h:commandButton id="icoBackTabTracking" 
                                 class="btn btn-signin butomclassECR imageRet" title="Back" action="#{RequestTracking.limpiar()}" onclick="backSupervisor();" style="position: fixed;top: 15px;height: 38px;">
                    <f:ajax execute="@this" render="@this refremeta"/>
                </h:commandButton> 
            </h:form>
            <h:form id="fmTrackingTabNw" class="fmTrackingTabAS" >  
                <div class="divTitleTracking">
                    <label class="labelTitleTracking">LIST</label>
                </div>
                    
                    <h:dataTable id="tblListadosTrackingTabNw" class="table table-striped dt-responsive anchoTableMantenimientos2" columnClasses=",three-prc,,ten-prc,ten-prc,twenty-prc,eight-prc,three-prc,six-prc" value='#{RequestTracking.listResponsesNameVw}'
                                  pt:name="tblListadosTrackingTabNw" var="item" style="cursor: pointer; position: initial;">                   
                    <h:column>
                        <f:facet name="header"> 
                            <h:outputText value="No"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="No"/>
                        </f:facet>      
                        <h:outputText value="#{RequestTracking.listResponsesNameVw.size()}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="No"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="No"/>
                        </f:facet>      
                        <h:outputText value="#{RequestTracking.listResponsesNameVw.size()- RequestTracking.listResponsesNameVw.indexOf(item)}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value=""/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value=""/>
                        </f:facet>      
                        <h:outputText value="#{item.resId}"/>
                    </h:column> 
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{gen_msg['subject']}"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="#{gen_msg['subject']}"/>
                        </f:facet>      
                             <h:outputText value="#{item.resSubject}"/>
                    </h:column> 
                         <h:column>
                        <f:facet name="header">
                            <h:outputText value="From"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="From"/>
                        </f:facet>      
                             <h:outputText value="#{item.primerNombre} #{item.primerApellido}"/>
                    </h:column> 
                        <h:column>
                        <f:facet name="header">
                            <h:outputText value="To"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="To"/>
                        </f:facet>      
                            <h:outputText value="#{item.resEmailsTo}"/>
                    </h:column> 
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Body"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="Body"/>
                        </f:facet>      
                        <h:outputText value="#{item.resBody}"/>
                    </h:column>
                        <h:column>
                        <f:facet name="header">
                            <h:outputText value="Records"/> 
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="Records"/>
                        </f:facet>      
                        <span class="glyphicon glyphicon-paperclip" style="margin: 0% 0% 0% 50%; display: #{item.tieneArchivos eq 'Y' ? ' inline-block;':'none;' }" ></span>
                    </h:column> 
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="#{gen_msg['date']}"/>
                        </f:facet>
                        <f:facet name="footer" >
                            <h:outputText value="#{gen_msg['date']}"/>
                        </f:facet>      
                        <h:outputText value="#{item.resDateMsg}">
                         <f:convertDateTime pattern="dd.MM.yyyy hh:mm a" timeZone="GMT-6" />   
                         </h:outputText>
                    </h:column>     
                </h:dataTable>
                <h:panelGroup id="scroptTracking"> 
                <h:outputScript>
                    splitTracking();                    
                    function splitTracking(){ 
                        $("#fmTrackingTabNw\\:tblListadosTrackingTabNw tbody tr").each(function (index) {
                        var selTrac=$(this);
                        var text1=$(this).children("td")[2].textContent;
                        selTrac.attr('onclick', 'selectTabTracking('+text1+');');
                        selTrac.attr('id', 'idECR'+index);
                        
                        });
                    }  
                    function splitTracking2(){ 
                    $("#fmTrackingTabNw .dt-buttons .buttons-mas").each(function (index) {
                        var selTrac=$(this);
                        selTrac.attr('onclick', 'addTracking()');
                        selTrac.attr('id', 'idTracking'+index);                        
                    }); 
                    $("#fmTrackingTabNw .dt-buttons .buttons-copy").addClass("ocultarTracking");
                    $("#fmTrackingTabNw .dt-buttons .buttons-csv").addClass("ocultarTracking"); 
                    $("#fmTrackingTabNw .dt-buttons .buttons-print").addClass("ocultarTracking"); 
                    $("#fmTrackingTabNw .dt-buttons .buttons-pdf").addClass("ocultarTracking"); 
                    $("#fmTrackingTabNw .dt-buttons .buttons-excel").addClass("ocultarTracking"); 
                } 
                                        
                    
                    formatTable2('table[name=tblListadosTrackingTabNw]','${swtLanguage.language}','#ghhghf','.menuDispo');

           
                    function formatTable2(tableId, language, insertModal,menu){
                            //agrega los input fields para los filtros
                            $(tableId + " tfoot td").each( function () {
                                var title = $(this).text();
                                if (!(!title || title.trim() == "")){
                                    $(this).html( '<input type="text" placeholder="'+title+'" style="width: 100%;"/>' );
                                }
                            } );

                            //crea la tabla con sus propiedades
                            var table = $(tableId).DataTable({
                                dom: 'lBfrtip',
                                sPaginationType: "full_numbers",
                                lengthMenu: [[25, 50, -1], [25, 50, "All"]],
                                columnDefs:[                                    
                                    {
                                        targets:[2],
                                        visible:false,
                                        searchable:true
                                    },
                                    {
                                        targets:[0],
                                        visible:false,
                                        searchable:true
                                    }
                                ],
                                buttons: [
                                 {className:'buttons-mas',text:'',  titleAttr: 'Add new',
                                                 action: function ( e, dt, node, config ) {
                                                                mostrarModal(insertModal);
                                                 },container: menu
                                 },
                                 {extend:'copy', text:'',container: menu, titleAttr: 'Copy'},
                                 {extend:'csv', text:'',container: menu, titleAttr: 'Export to csv'}, 
                                 {extend:'print', text:'',container: menu,titleAttr: 'Print'},
                                 {extend:'pdf', text:'',container: menu,titleAttr: 'Export to pdf'},
                                 {extend:'excel', text:'',container: menu,titleAttr: 'Export to Excel'}
                                 ]
                            });
                            //agrega la función de filtrado a los input generados anteriormente
                            table.columns().every( function () {
                                var that = this;
                                $( 'input', this.footer() ).on( 'keyup change', function () {
                                    if ( that.search() !== this.value ) {
                                        that
                                            .search( this.value )
                                            .draw();
                                    }
                                } );
                            } );
                            //cambia de color al registro seleccionado
                            $(tableId + ' tbody').on('click','tr',function(){
                                $(tableId + ' tbody tr').removeClass('selected');
                                $(this).toggleClass('selected');

                            });

                        };
                        splitTracking2();
                </h:outputScript>
                    </h:panelGroup>
            </h:form>
            <h:form id="formTrackingForAir" style="position: absolute; z-index: 9999999999;  top: 100%;    left: 93%; display: none;">
                 <h:commandButton id="addTrackingForAir" class="btn-circle btn-xl btn-danger"  value="+"  action="#{engtabECRnwsVwBean.autoComplete()}">
                        <f:ajax execute="@this" render="@this inputForm70 refremeta"/>
                    </h:commandButton>
                <h:commandButton id="renderTABTracking" value="+"  style="display: none;">
                        <f:ajax execute="@this" render="@this fmECRTabNw fmInfoWork"/>
                    </h:commandButton>                   
            </h:form>
            
        </h:body>
    </f:view>
</html>

           